<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel de Voos - LATAM</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 2rem;
      background-color: #f5f6fa;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 2rem;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      padding: 1.2rem 1.5rem;
      margin-bottom: 1.5rem;
      line-height: 1.6;
      color: #444;
    }

    strong {
      color: #111;
    }

    .erro {
      color: red;
      text-align: center;
      margin-top: 2rem;
    }

    .loading {
      text-align: center;
      font-size: 1.2rem;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>Painel de Voos Cortados - LATAM</h1>
  <div id="status" class="loading">Carregando dados...</div>
  <ul id="lista-voos"></ul>

  <script>
    const url = 'https://script.google.com/macros/s/AKfycbymWN6wZteNypipOJnIiWgyrOEwqZwyfFr3dGwtNBq3z_9Eu54N4FEsFES7jnquns0I/exec';

    fetch(url)
      .then(response => response.json())
      .then(dados => {
        const lista = document.getElementById('lista-voos');
        const status = document.getElementById('status');

        const dadosFiltrados = dados.filter(item => item.voo && item.peso && item.motivo);

        if (dadosFiltrados.length === 0) {
          status.textContent = 'âœ… Nenhum voo cortado no momento.';
          return;
        }

        status.style.display = 'none';

        dadosFiltrados.forEach(item => {
          const li = document.createElement('li');
          li.innerHTML = `
            <strong>Voo:</strong> ${item.voo}<br>
            <strong>Tipo:</strong> ${item.tipo}<br>
            <strong>Rota:</strong> ${item.rota}<br>
            <strong>Motivo:</strong> ${item.motivo}<br>
            <strong>Peso:</strong> ${item.peso}<br>
            <strong>Data:</strong> ${formatarData(item.data)}<br>
            <strong>Hora:</strong> ${item.hora}
          `;
          lista.appendChild(li);
        });
      })
      .catch(error => {
        console.error('Erro ao buscar dados:', error);
        document.getElementById('status').className = 'erro';
        document.getElementById('status').textContent = 'Erro ao carregar dados.';
      });

    function formatarData(data) {
      if (!data) return '-';
      const dt = new Date(data);
      if (isNaN(dt)) return data;
      return dt.toLocaleDateString('pt-BR');
    }
  </script>
</body>
</html>
